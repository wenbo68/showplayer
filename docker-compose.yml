services:
  #container name
  app:
    image: showplayer:2.1
    build:
      context: .
      # only needed if you have env vars that are needed at build time
      args:
        - AUTH_SECRET=${AUTH_SECRET}
        - DATABASE_URL=${DATABASE_URL}
        - TMDB_API_KEY=${TMDB_API_KEY}
        - VPS_URL=${VPS_URL}
        - FRONTEND_URL=${FRONTEND_URL}
        - HEADLESS=${HEADLESS}
        - FIRST_CLICK=${FIRST_CLICK}
        - LONG_CLICK=${LONG_CLICK}
        - MID_CLICK=${MID_CLICK}
        - SHORT_CLICK=${SHORT_CLICK}
        - M3U8_WAIT=${M3U8_WAIT}
        - M3U8_WAIT_EASY=${M3U8_WAIT_EASY}
    # maps the vps port 8080 to the container's port 3000
    ports:
      - '8080:3000'
    # docker compose will use the .env file
    environment:
      - NODE_ENV=production
      - AUTH_SECRET=${AUTH_SECRET}
      - DATABASE_URL=${DATABASE_URL}
      - TMDB_API_KEY=${TMDB_API_KEY}
      - VPS_URL=${VPS_URL}
      - FRONTEND_URL=${FRONTEND_URL}
      - HEADLESS=${HEADLESS}
      - FIRST_CLICK=${FIRST_CLICK}
      - LONG_CLICK=${LONG_CLICK}
      - MID_CLICK=${MID_CLICK}
      - SHORT_CLICK=${SHORT_CLICK}
      - M3U8_WAIT=${M3U8_WAIT}
      - M3U8_WAIT_EASY=${M3U8_WAIT_EASY}
    restart: unless-stopped
